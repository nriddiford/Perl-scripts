# cigar_compare.pl

This program comapres cigars from reads that are tagged as mapping to multiple genomes.
  * If the alternative alignment has a higher match value it will be treated as contamination and filtered out. 
  * If the alternative alignment has a lower match value it will be kept.

# Input

The program accepts as input a .bam file generated by running [tag_reads.py](https://github.com/bardin-lab/read_tagger).

Here, reads also mapping to an alternative genome are tagged as CR and mates as DR.

### Data should look something like this:

```
HWI-D00405:129:C6KNAANXX:4:1301:15758:14178	147	2L	10623656	44	30S20M75S	=	10623656	-20	AAACCCTTCGCGCTGATTACCGTAAAATTGCGGAACGCCGCGTAAAGTTGGGTCTGCTTCTGGCTGAAATTGGCCGTAAGAACAATATTACGGTTACGCCGGACGAATTGGGCCGGGCAGTGCGG	FFFFFFFBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBBB	CD:Z:R:NC_013209.1,POS:1784515,CIGAR:125M,S:S	DD:Z:R:NC_013209.1,POS:1784538,CIGAR:125M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:20	XS:i:0
HWI-D00405:129:C6KNAANXX:4:1208:13229:45414	99	2L	10636856	40	87S19M19S	=	10636856	19	AAAAGTGGATGCATGGGCAATATGGGATCCATATCTCTCAGGTGTCAGCAGTCCGGTACGCGTGTTAGCAACTGGAGATGATGTTCAGGGTGGAACGGAATTTTATCTTGCAGGAAAGGAGTTTT	BBBBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFF	CD:Z:R:NC_013209.1,POS:1447617,CIGAR:14S111M,S:AS	DD:Z:R:NC_013209.1,POS:1447617,CIGAR:15S110M,S:S	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:1301:16880:13271	99	2L	10636856	40	99S19M7S	=	10636856	19	GTTTGAAGGCGGAAAAGTGGATGCATGGGCAATATGGGATCCATATCTCTCAGGTGTCAGCAGTCCGGTACGCGTGTTAGCAACTGGAGATGATGTTCAGGGTGGAACGGAATTTTATCTTGCAG	BBBBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	CD:Z:R:NC_013209.1,POS:1447617,CIGAR:2S123M,S:AS	DD:Z:R:NC_013209.1,POS:1447594,CIGAR:14S106M5S,S:S	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:1208:13229:45414	147	2L	10636856	40	86S19M20S	=	10636856	-19	AAAGTGGATGCATGGGCAATATGGGATCCATATCTCTCAGGTGTCAGCAGTCCGGTACGCGTGTTAGCAACTGGAGATGATGTTCAGGGTGGAACGGAATTTTATCTTGCAGGAAAGGAGTTTTA	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBBB	CD:Z:R:NC_013209.1,POS:1447617,CIGAR:15S110M,S:S	DD:Z:R:NC_013209.1,POS:1447617,CIGAR:14S111M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:1301:16880:13271	147	2L	10636856	40	64S19M42S	=	10636856	-19	GGGATCCATATCTCTCAGGTGTCAGCAGTCCGGTACGCGTGTTAGCAACTGGAGATGATGTTCAGGGTGGAACGGAATTTTATCTTGCAGGAAAGGAGTTTTATCAAAAAAATCCAGAGCTTTTG	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBBB	CD:Z:R:NC_013209.1,POS:1447594,CIGAR:14S106M5S,S:S	DD:Z:R:NC_013209.1,POS:1447617,CIGAR:2S123M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2310:17782:39172	163	2L	10749280	49	76S21M28S	=	10749280	21	CTCGATCCTTGAAAGGCGTGTCATTTGGGTGCCTCCACTCGATTGATGACCCACAAACGCTAACGTACTGAGGATAAGAAAGTTCATGTTAATTTCATATATCACGCCCTGCTGGCATGCGGGCT	<BBBBFFFFFFFFFFFFFFFFFFFFFBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF/BBBFFFFFFF	CD:Z:R:NC_013209.1,POS:1106020,CIGAR:5S120M,S:AS	DD:Z:R:NC_013209.1,POS:1105959,CIGAR:125M,S:S	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:21	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2310:17782:39172	83	2L	10749280	49	20S21M84S	=	10749280	-21	ACGCTAACGTACTGAGGATAAGAAAGTTCATGTTAATTTCATATATCACGCCCTGCTGGCATGCGGGCTGAGCATAGAAGTTTTTTTGTAATCCTGGCTGGCGTCCGGCTCTTACATGGTAAACA	BFFFFFFFFFFBFFFFFFFBF<F77FFFFFFFFFFFBFFFFFFFF<FFFFFFFFFFFFBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFFB<FFFFFFFFFFBFFBBBBB	CD:Z:R:NC_013209.1,POS:1105959,CIGAR:125M,S:S	DD:Z:R:NC_013209.1,POS:1106020,CIGAR:5S120M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:21	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2315:1428:48303	99	2L	11095832	40	78S19M28S	=	11095832	19	GTCGGCAATGTCATTCACCTGAAACTCATCAAAGCACAGAAGCTGCGCCTTGCTGGCGATGGTTTTGGCCAAAGGCGGAATGGGATCTGCCATATTGGGGTTGGCGGCTTTAAGATCATGCAGAT	BBBBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	CD:Z:R:NC_013209.1,POS:794334,CIGAR:125M,S:AS	DD:Z:R:NC_013209.1,POS:794311,CIGAR:125M,S:S	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2315:1428:48303	147	2L	11095832	40	55S19M51S	=	11095832	-19	ACTCATCAAAGCACAGAAGCTGCGCCTTGCTGGCGATGGTTTTGGCCAAAGGCGGAATGGGATCTGCCATATTGGGGTTGGCGGCTTTAAGATCATGCAGATCACGGTGCACATCCTGCATGAAG	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBBB	CD:Z:R:NC_013209.1,POS:794311,CIGAR:125M,S:S	DD:Z:R:NC_013209.1,POS:794334,CIGAR:125M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:19	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2316:1861:69366	163	2L	11364945	49	29S21M75S	=	11364947	21	TCCGCAGATACAAATAGCTCCAAAGCATAACGCATCCGAGTACGTCTACTTCTTCAAAACGCTTCTGAACGCTTACATCAGAAATGCTTAACGCATGAGTAAATCTCTCTACTCAATACGGGTCA	BBBBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFFFFFBFFFFFFFFFF	CD:Z:R:NC_013209.1,POS:2767136,CIGAR:125M,S:S	DD:Z:R:NC_013209.1,POS:2767167,CIGAR:125M,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	DR:Z:NC_013209.1	AS:i:21	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2303:9571:89285	163	X	2988450	60	125M	=	2988587	262	CTTGGCTTCCTTGGCAAATTGCGCTAGACAGGATCGTCGGGTTTTGTGGTAGGCACAGGCACAGGCACAGGCACAGGCACAGGCACTCTCACATTTGCCTGGCGGTGGCATTTTAATTGGCAGCC	BBBBBFFFFFFFFFFFBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFFFFFFFFFFFBFFFFFFFFFFFFFFFFFFF	CD:Z:R:NC_013209.1,POS:283611,CIGAR:39S36M50S,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	CR:Z:NC_013209.1	AS:i:125	XS:i:0
HWI-D00405:129:C6KNAANXX:4:2303:9571:89285	83	X	2988587	60	125M	=	2988450	-262	AACATGGGCAGGAATTCGCCAAAGACGGAAGCGCATATTCACCTTCATACCGTTGCATGTCCTCGGGTGCATGTGTTTGTGTGTGTGTATATATGCCTAGGTGTGCATGTGCTCGCATACCCACC	FFFFFFFFFFFFFB<FFFFFFFFFFFFF7<BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBBBB	DD:Z:R:NC_013209.1,POS:283611,CIGAR:39S36M50S,S:AS	PG:Z:MarkDuplicates	RG:Z:HUM-1	NM:i:0	DR:Z:NC_013209.1	AS:i:125	XS:i:0
```

Run as `perl cigar_compare.pl -h` to see usage statement

```
******** cigar_compare.pl ********
Usage: cigar_comapre.pl [options]
  --bam = specify bam file processed with 'tag_reads.py' [default 'files/test.bam']
  --debug = run in debug mode
  --help = print this help message and exit

Nick Riddiford 2017
```